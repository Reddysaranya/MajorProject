{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nutrition Tracker</title>
   
    <meta charset="utf-8" />
    <script type="text/javascript">
        function googleTranslateElementInit() {
          new google.translate.TranslateElement({
            pageLanguage: 'en', // default language of your page
            includedLanguages: 'hi,ta,te,kn,ml,mr,bn,gu,pa,ur', // only Indian languages
            layout: google.translate.TranslateElement.InlineLayout.SIMPLE
          }, 'google_translate_element');
        }
      
        // Function to trigger the Google Translate language change
        function changeLanguage(languageCode) {
          const select = document.querySelector('select.goog-te-combo');
          if (select) {
            select.value = languageCode;
            select.dispatchEvent(new Event('change')); // Trigger the change event to translate the page
          }
        }
      </script>
      
      <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
  

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800,900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <title>Fight Famishment</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/font-awesome.css' %}">
    <link rel="stylesheet" href="{% static 'css/templatemo-klassy-cafe.css' %}">
    <link rel="stylesheet" href="{% static 'css/owl-carousel.css' %}">
    <link rel="stylesheet" href="{% static 'css/lightbox.css' %}">
    <style>
        .nav__ul a {
            color: #fff;
        }

        .nav__ul--extra {
            column-count: 2;
            column-gap: 1.25em;
        }

        .legal {
            display: flex;
            flex-wrap: wrap;
            color: #fff;
        }

        .legal__links {
            display: flex;
            align-items: center;
        }

        .heart {
            color: #fff;
        }

        @media screen and (min-width: 24.375em) {
            .legal .legal__links {
                margin-left: auto;
            }
        }
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #fb5849;
            color: black;
           
        }
        
        #container {
            max-width: 800px;
            margin: 0px auto;
            margin-top:3px;
            padding: 20px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #fb5849;
            font-weight:bold;
        }
        
        form {
            margin-bottom: 20px;
        }
        
        fieldset {
            border: none;
            margin: 0;
            padding: 0;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
        }
        
        select {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        
        input[type="text"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        
        button[type="submit"] {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #fb5849;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        button[type="submit"]:hover {
            background-color: #c03542;
        }
        
        #bmiDisplay {
            text-align: center;
            color: #e4485f;
        }
        
        #bmiDisplay h2 {
            margin-bottom: 5px;
        }
        
        #bmiDisplay p {
            font-size: 24px;
            font-weight: bold;
            margin-top: 0;
        }
        
        /* Grid layout */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            grid-gap: 10px;
        }
        
        /* Apply grid layout to food item divs */
        .food-item {
            margin-bottom: 10px;
        }
        /* Add this CSS to reset margins and paddings */

  /* Style for individual radio button items */
  .radio-item {
    flex: 0 0 calc(50% - 10px); /* Adjust width to accommodate two items in a row with spacing */
    margin-bottom: 10px; /* Add some bottom margin for spacing */
  }
  
  .voice-icon {
    cursor: pointer;
    margin-left: 10px;
    color: #fb5849;
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
  }
  
  .voice-icon:hover {
    color: #c03542;
  }
  
  .input-group {
    position: relative; /* Position relative for the icon to be positioned within the group */
    display: flex;
    align-items: center;
  }
  
  .input-group input,
  .input-group select {
    flex: 1;
    padding-right: 40px; /* Space for the icon on the right */
  }
  
  .input-group i {
    position: absolute;
    right: 10px; /* Adjust this value for spacing from the right */
    top: 50%;
    transform: translateY(-50%); /* Vertically center the icon */
    cursor: pointer;
    color: #fb5849;
  }
  

/* Header Styling */
.my_new-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #ffffff; /* White background for header */
    padding: 50px 30px;
    border-bottom: 1px solid #ddd;
}



/* Navigation Links Styling */
.my_new-nav {
    display: flex;
    align-items: center;
    gap: 20px; /* Space between links */
}

.my_new-nav-link {
    text-decoration: none;
    color: #000000; /* Black text color for links */
    font-size: 16px;
    font-weight: bold; /* Bold links */
    padding: 10px 15px; /* Increase padding for top, bottom, left, and right */
    transition: color 0.3s, background-color 0.3s;
}

/* Active and Hover Effect for Navigation Links */
.my_new-nav-link:hover, .my_new-nav-link.active {
    color: #fb5849; /* Active/Hover color */
}

/* Check BMI Button Styling */
.my_new-button {
    background-color: #000000; /* Black background for button */
    color: #ffffff; /* White text for button */
    padding: 10px 20px; /* Padding for top, bottom, left, and right */
    border-radius: 20px; /* Rounded corners */
    text-decoration: none;
    font-weight: bold;
    transition: background-color 0.3s;
}

.my_new-button:hover {
    background-color: #fb5849; /* Hover color for button */
}

/* Google Translate Styling */
.my_new-translate {
    margin-left: 20px;
}/* Active and Hover Effect for Navigation Links */
.my_new-nav-link:hover, .my_new-nav-link.active {
    color: #fb5849; /* Active/Hover color */
}

/* Custom Styling to Force Vertical Dropdown */
.goog-te-menu-frame {
    width: 200px !important;
    height: auto !important;
    max-height: 300px !important;
    overflow-y: scroll !important;
}

/* Adjust dropdown container */
.goog-te-menu-value {
    padding: 10px 15px;
}

/* Styling for language list */
.goog-te-menu2 {
    display: block !important;
    width: 150px !important;
    position: absolute;
}

.goog-te-menu2-item {
    display: block;
}
#reservation{
    margin-top:-50px;
    margin-bottom:0px;
}
/* Style for error messages */
.error-msg {
    color: red;
    font-size: 12px;
    margin-top: 5px;
    display: block;
}

/* Style for input fields with errors */
input:invalid, select:invalid {
    border: 2px solid red;
}

/* Highlighting input fields with errors when focused */
input:invalid:focus, select:invalid:focus {
    outline: none;
    border-color: red;
}

/* Style for required fields */
input:required, select:required {
    background-color: red; /* Light pink background */
}



    </style>
</head>
<body>
    <header class="my_new-header">
        <!-- Logo on the left -->
        <div class="my_new-logo">
            <a href="/" class="logo">
                <img src="static/images/FFlogo.png">
            </a>
        </div>
    
        <!-- Navigation links on the right -->
        <nav class="my_new-nav">
            <a href="/" class="my_new-nav-link">Home</a>
            <a href="about" class="my_new-nav-link">About</a>
            <a href="blog" class="my_new-nav-link ">Articles</a>
            <a href="bmi" class="my_new-nav-link active">Predict BMI</a>
            <a href="/#reservation" class="my_new-button">Check BMI</a>
        </nav>
    
        <!-- Google Translate Element -->
        <div id="google_translate_element" class="my_new-translate"></div>
    </header>
    
    
    <!-- Google Translate Script -->
    <script type="text/javascript">
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'en',
                includedLanguages: 'hi,ta,te,kn,ml,mr,bn,gu,pa,ur',
                layout: google.translate.TranslateElement.InlineLayout.SIMPLE
            }, 'google_translate_element');
        }
    </script>
    <script async type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
    
    
    <section class="section" id="reservation">
    <div id="container">
        <h2>Nutrition Tracker</h2>
        
        <form id="nutritionForm" method="post" action="{% url 'bmi_predicted' %}">
            {% csrf_token %}
            
            <div class="grid-container">
                <div class="food-item">
                    <label for="rice">Rice:</label>
                    <div class="input-group">
                        <select id="rice" name="rice">
                            <option value="">Select</option>
                            <option value="0">None</option>
                            <option value="100">Small (100g)</option>
                            <option value="200">Medium (200g)</option>
                            <option value="300">Large (300g)</option>
                        </select>
                        <i class="fas fa-microphone voice-icon" onclick="startVoiceInput(document.getElementById('rice'))"></i>
                    </div>
                    <div class="error-msg" id="riceError"></div>
                </div>
                
                <div class="food-item">
                    <label for="roti">Roti/Chapati:</label>
                    <div class="input-group">
                        <select id="roti" name="roti">
                            <option value="">Select</option>
                            <option value="0">None</option>
                            <option value="1">One</option>
                            <option value="2">Two</option>
                            <option value="3">Three</option>
                        </select>
                        <i class="fas fa-microphone voice-icon" onclick="startVoiceInput(document.getElementById('roti'))"></i>
                    </div>
                    <div class="error-msg" id="rotiError"></div>
                </div>
        
                <div class="food-item">
                    <label for="dal">Dal (lentils):</label>
                    <div class="input-group">
                        <select id="dal" name="dal">
                            <option value="">Select</option>
                            <option value="0">None</option>
                            <option value="50">Small (50g)</option>
                            <option value="100">Medium (100g)</option>
                            <option value="150">Large (150g)</option>
                        </select>
                        <i class="fas fa-microphone voice-icon" onclick="startVoiceInput(document.getElementById('dal'))"></i>
                    </div>
                    <div class="error-msg" id="dalError"></div>
                </div>
        
                <div class="food-item">
                    <label for="eggs">Eggs/Paneer:</label>
                    <div class="input-group">
                        <select id="eggs" name="eggs">
                            <option value="">Select</option>
                            <option value="0">None</option>
                            <option value="1">One serving</option>
                            <option value="2">Two servings</option>
                            <option value="3">Three servings</option>
                        </select>
                        <i class="fas fa-microphone voice-icon" onclick="startVoiceInput(document.getElementById('eggs'))"></i>
                    </div>
                    <div class="error-msg" id="eggsError"></div>
                </div>
        
                <div class="food-item">
                    <label for="sabzi">Sabzi (vegetable curry):</label>
                    <div class="input-group">
                        <select id="sabzi" name="sabzi">
                            <option value="">Select</option>
                            <option value="0">None</option>
                            <option value="1">One serving</option>
                            <option value="2">Two servings</option>
                            <option value="3">Three servings</option>
                        </select>
                        <i class="fas fa-microphone voice-icon" onclick="startVoiceInput(document.getElementById('sabzi'))"></i>
                    </div>
                    <div class="error-msg" id="sabziError"></div>
                </div>
        
                <div class="food-item">
                    <label for="fruits">Seasonal fruits:</label>
                    <div class="input-group">
                        <select id="fruits" name="fruits">
                            <option value="">Select</option>
                            <option value="0">None</option>
                            <option value="50">Small portion</option>
                            <option value="100">Medium portion</option>
                            <option value="150">Large portion</option>
                        </select>
                        <i class="fas fa-microphone voice-icon" onclick="startVoiceInput(document.getElementById('fruits'))"></i>
                    </div>
                    <div class="error-msg" id="fruitsError"></div>
                </div>
        
                <div class="food-item">
                    <label for="buttermilk">Buttermilk:</label>
                    <div class="input-group">
                        <select id="buttermilk" name="buttermilk">
                            <option value="">Select</option>
                            <option value="0">None</option>
                            <option value="1">Small glass</option>
                            <option value="2">Medium glass</option>
                            <option value="3">Large glass</option>
                        </select>
                        <i class="fas fa-microphone voice-icon" onclick="startVoiceInput(document.getElementById('buttermilk'))"></i>
                    </div>
                    <div class="error-msg" id="buttermilkError"></div>
                </div>
        
                <div class="food-item">
                    <label for="juice">Juice:</label>
                    <div class="input-group">
                        <select id="juice" name="juice">
                            <option value="">Select</option>
                            <option value="0">None</option>
                            <option value="1">Small glass</option>
                            <option value="2">Medium glass</option>
                            <option value="3">Large glass</option>
                        </select>
                        <i class="fas fa-microphone voice-icon" onclick="startVoiceInput(document.getElementById('juice'))"></i>
                    </div>
                    <div class="error-msg" id="juiceError"></div>
                </div>
        
                <div class="form-floating">
                    <input type="number" class="form-control bg-light border-2 border-dark" id="height" name="height" placeholder="Child's height in cm" step="0.01" >
                    <label for="height">Child's height in cm</label>
                    <i class="fas fa-microphone voice-icon" onclick="startVoiceInput(document.getElementById('height'))"></i>
                    <div class="error-msg" id="heightError"></div>
                </div>
        
                <div class="form-floating">
                    <input type="number" class="form-control bg-light border-2 border-dark" id="weight" name="weight" placeholder="Child's weight in kg" step="0.01" >
                    <label for="weight">Child's weight in kg</label>
                    <i class="fas fa-microphone voice-icon" onclick="startVoiceInput(document.getElementById('weight'))"></i>
                    <div class="error-msg" id="weightError"></div>
                </div>
        
                <div class="food-item">
                    <label for="workout">Workout in minutes:</label>
                    <div class="input-group">
                        <select id="workout" name="workout">
                            <option value="">Select</option>
                            <option value="0">None</option>
                            <option value="1">30</option>
                            <option value="2">45</option>
                            <option value="3">60</option>
                        </select>
                        <i class="fas fa-microphone voice-icon" onclick="startVoiceInput(document.getElementById('workout'))"></i>
                    </div>
                    <div class="error-msg" id="workoutError"></div>
                </div>
            </div>
        
            <br>
            <button type="submit">Estimate</button>
        </form>
        


    </div>
</section>
<script>
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    if (SpeechRecognition) {
        const recognition = new SpeechRecognition();
        recognition.continuous = false;
        recognition.interimResults = true;
        recognition.lang = 'en-US';

        let voiceTarget; // To store the target input field

        // Map for voice inputs based on field id
        const fieldValueMap = {
            "rice": {
                "none": "0",
                "small": "100",   // Small portion (100g)
                "medium": "200",  // Medium portion (200g)
                "large": "300"    // Large portion (300g)
            },
            "roti": {
                "none": "0",
                "one": "1",
                "two": "2",
                "three": "3"
            },
            "dal": {
                "none": "0",
                "small": "50",    // Small portion (50g)
                "medium": "100",  // Medium portion (100g)
                "large": "150"    // Large portion (150g)
            },
            "eggs": {
                "none": "0",
                "one": "1",       // One serving
                "two": "2",       // Two servings
                "three": "3"      // Three servings
            },
            "sabzi": {
                "none": "0",
                "one": "1",       // One serving
                "two": "2",       // Two servings
                "three": "3"      // Three servings
            },
            "fruits": {
                "none": "0",
                "small": "50",    // Small portion (50g)
                "medium": "100",  // Medium portion (100g)
                "large": "150"    // Large portion (150g)
            },
            "buttermilk": {
                "none": "0",
                "small glass": "1",
                "medium glass": "2",
                "large glass": "3"
            },
            "juice": {
                "none": "0",
                "small glass": "1",
                "medium glass": "2",
                "large glass": "3"
            },
            "workout": {
                "none": "0",
                "thirty": "1",    // 30 minutes
                "forty five": "2",// 45 minutes
                "sixty": "3"      // 60 minutes
            }
        };
        
        // Handle the result of the voice recognition
        recognition.onresult = function(event) {
            const transcript = event.results[0][0].transcript.toLowerCase().trim(); // Normalize input to lowercase

            if (voiceTarget.tagName === 'SELECT') {
                // Get the corresponding mapping for the field
                const fieldId = voiceTarget.id;
                const mappedValue = fieldValueMap[fieldId]?.[transcript];
                
                if (mappedValue !== undefined) {
                    voiceTarget.value = mappedValue; // Set the value from the map
                } else {
                    console.log('Unrecognized input for field', fieldId, ':', transcript);
                }
            } else if (voiceTarget.tagName === 'INPUT') {
                // If the target is an input field, directly assign the transcript value
                voiceTarget.value = transcript;
            }
        };

        // Function to start voice input for the target field
        function startVoiceInput(target) {
            voiceTarget = target;  // Set the target input field
            recognition.start();   // Start speech recognition
            
        }

        recognition.onend = function() {
            // Optional: Add additional logic when speech recognition ends
            

        };
    } else {
        console.log('Web Speech API is not supported by this browser.');
    }
</script>


<<script>
    // Function to validate the form
function validateForm() {
    let isValid = true;

    // Reset error messages
    const errorMsgs = document.querySelectorAll('.error-msg');
    errorMsgs.forEach(msg => msg.innerHTML = "");

    // Get values from fields
    const rice = document.getElementById('rice').value;
    const roti = document.getElementById('roti').value;
    const dal = document.getElementById('dal').value;
    const eggs = document.getElementById('eggs').value;
    const sabzi = document.getElementById('sabzi').value;
    const fruits = document.getElementById('fruits').value;
    const buttermilk = document.getElementById('buttermilk').value;
    const juice = document.getElementById('juice').value;
    const height = document.getElementById('height').value;
    const weight = document.getElementById('weight').value;
    const workout = document.getElementById('workout').value;

    // Validating food items
    const foodItems = ['rice', 'roti', 'dal', 'eggs', 'sabzi', 'fruits', 'buttermilk', 'juice'];
    foodItems.forEach(item => {
        if (document.getElementById(item).value === "") {
            document.getElementById(item + 'Error').innerHTML = "This field is mandatory.";
            isValid = false;
        }
    });

    // Validating height and weight
    if (height === "") {
        document.getElementById('heightError').innerHTML = "This field is mandatory.";
        isValid = false;
    } else if (isNaN(height) || height < 30 || height > 300) {
        document.getElementById('heightError').innerHTML = "Height must be between 30 cm and 300 cm.";
        isValid = false;
    }

    if (weight === "") {
        document.getElementById('weightError').innerHTML = "This field is mandatory.";
        isValid = false;
    } else if (isNaN(weight) || weight < 2 || weight > 300) {
        document.getElementById('weightError').innerHTML = "Weight must be between 2 kg and 300 kg.";
        isValid = false;
    }

    // Validating workout time
    if (workout === "") {
        document.getElementById('workoutError').innerHTML = "This field is mandatory.";
        isValid = false;
    }

    return isValid;
}

// Add event listener to form submit
document.getElementById('nutritionForm').onsubmit = function(event) {
    event.preventDefault(); // Prevent the form from submitting until validation
    if (validateForm()) {
        this.submit(); // Submit the form if it's valid
    }
};

</script>>

</body>
</html>